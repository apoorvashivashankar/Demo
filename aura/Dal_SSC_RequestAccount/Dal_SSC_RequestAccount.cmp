<aura:component description="Dal_SSC_RequestAccount" extends="c:Dal_Dist_FormModalBase" controller="ProExchangeUtility" implements="force:appHostable,flexipage:availableForAllPageTypes,forceCommunity:availableForAllPageTypes">
    <aura:attribute name="newCase" type="Case" />
    <force:recordData aura:id="forceRecord"
                      recordId="{!v.recordId}"
                      targetFields="{!v.newCase}"
                      fields="Id,AccountId,First_Name__c,Last_Name__c,Email_Address__c,Phone_Number__c,User_Access__c,Add_to_all_accounts__c,Current_or_New_Customer__c,AccountName__c,DBA__c,Address_Line_1__c,Address_Line_2__c,City__c,State__c,Zip__c,Country__c,PO_Number_Required__c,AccountNumber__c,Subject,Add_New_Account__c"
                      mode="EDIT" /> 

    <aura:attribute name="createAccountParent" type="Boolean" />
    <aura:attribute name="isCanadian" type="Boolean" default="false"/>
    <aura:attribute name="isInternational" type="Boolean" default="false"/>
    <aura:attribute name="errorMessage" type="String" />
    
    <ui_modal:modal aura:id="modalErrorMessage" title="Oops..." isDirectional="true" isLarge="false" hasCloseIcon="true">
        <!-- Modal tagline -->
        <aura:set attribute="tagline">
            Sorry, it looks like there was an issue creating your ProExchange Account.       
        </aura:set>
        <!-- Modal body -->
        <div>
            {!v.errorMessage}
        </div>
    </ui_modal:modal>    
    
    <ui_modal:modal aura:id="modalAccountRequestedWorking" title="Please wait..." isDirectional="true" isLarge="false" hasCloseIcon="false">
        <!-- Modal tagline -->
        <aura:set attribute="tagline">
            <div class="demo-only" style="height: 6rem;">
              <div role="status" class="slds-spinner slds-spinner_brand slds-spinner_large">
                <span class="slds-assistive-text">Loading</span>
                <div class="slds-spinner__dot-a"></div>
                <div class="slds-spinner__dot-b"></div>
              </div>
            </div>            
            We are setting up your request.<br/>        
        </aura:set> 
    </ui_modal:modal>   
    
    <ui_modal:modal aura:id="modalAccountRequested" title="ProExchange Account Requested!" isDirectional="true" isLarge="false" hasCloseIcon="false">
        <!-- Modal tagline -->
        <aura:set attribute="tagline">
            We have received your information and will start working on getting you setup.<br/>        
        </aura:set>
        
        <lightning:button label="Back To Login" onclick="{!c.handleClose}" />      
    </ui_modal:modal>       
    
    <aura:set attribute="title" value="SSC Portal" />
    <aura:set attribute="subtitle" value="Registration for Access to ProExchange" />
    <aura:set attribute="description" value="Complete this information to receive your access to ProExchange. 
                                             Your account will be processed within 2 business days, 
                                             during which time, you may be contacted for additional clarification." />
    
    <aura:attribute name="createAccountChild" type="Boolean" default="false"/>
    <aura:attribute name="states" type="List" default="[]"/>
    <aura:attribute name="countries" type="List" default="[]"/>
    <aura:attribute name="accountAccess" type="List" default="getAccountAccessNew();"/>
    
    <aura:handler name="init" action="{!c.init}" value="{!this}"/>
    <aura:handler name="change" value="{!v.createAccountChild}" action="{!c.onChildAttributeChange}"/>

    <lightning:layout class="slds-p-vertical_medium" multipleRows="true">
        <!-- Form left column -->
        <lightning:layoutItem class="slds-p-horizontal_medium" size="12" smallDeviceSize="12" mediumDeviceSize="6" largeDeviceSize="6">
            <div class="slds-form slds-form_stacked">
                <h4>Company Information</h4>
                
                <lightning:input aura:id="caseAccountName" name="caseAccountName" label="Company Name" type="text" class="slds-p-vertical_x-small" maxlength="50" />
                <aura:if isTrue="{!v.createAccountChild}">
                    <lightning:input aura:id="caseDBAName" name="caseDBAName" label="DBA Name (Optional)" type="text" class="slds-p-vertical_x-small" maxlength="75" />
                    <lightning:input aura:id="caseAddressLine1" name="caseAddressLine1" label="Street Address" type="text" class="slds-p-vertical_x-small" maxlength="75" />
                    <lightning:input aura:id="caseAddressLine2" name="caseAddressLine2" label="Address Line 2 (Optional)" placeholder="Apartment, suite, building, floor, etc." type="text" class="slds-p-vertical_x-small" maxlength="75" />
                    <lightning:layout pullToBoundary="small" multipleRows="true">
                        <lightning:layoutItem size="6" class="slds-p-horizontal_small">
                            <lightning:select aura:id="caseCountry" name="caseCountry" label="Country" class="slds-p-vertical_x-small" onchange="{!c.handleAddressUpdate}">
                                <option value=""></option>
                                <aura:iteration items="{!v.countries}" var="item">
                                    <option value="{!item.value}">{!item.label}</option>
                                </aura:iteration>
                            </lightning:select>
                        </lightning:layoutItem>
                        <aura:if isTrue="{!v.isInternational}">     
                            <!--address for IT accounts-->
                            <lightning:layoutItem size="6" class="slds-p-horizontal_small">
                                <lightning:input aura:id="caseITState" name="caseITState" label="State / Province" type="text" class="slds-p-vertical_x-small" maxlength="250" />
                            </lightning:layoutItem>     
							<lightning:layoutItem size="6" class="slds-p-horizontal_small">
								<lightning:input aura:id="caseITCity" name="caseITCity" label="City / Town / Locality" type="text" class="slds-p-vertical_x-small" maxlength="50" />
							</lightning:layoutItem>          
                            <lightning:layoutItem size="6" class="slds-p-horizontal_small">
                                <lightning:input aura:id="caseITZip" name="caseITZip" label="Postal Code" type="text" class="slds-p-vertical_x-small" maxlength="15" />
                            </lightning:layoutItem>    
                            <!--address for IT accounts-->
                            <aura:set attribute="else">   
                                <aura:if isTrue="{!v.isCanadian}">  
								    <!-- address for CA accounts-->
                                    <lightning:layoutItem size="6" class="slds-p-horizontal_small">
                                        <lightning:select aura:id="caseCAState" name="caseCAState" label="Province" class="slds-p-vertical_x-small">
                                            <option value=""></option>
                                            <aura:iteration items="{!v.states}" var="item">
                                                <option value="{!item.value}">{!item.label}</option>
                                            </aura:iteration>
                                        </lightning:select>
                                    </lightning:layoutItem>   
									<lightning:layoutItem size="6" class="slds-p-horizontal_small">
										<lightning:input aura:id="caseCACity" name="caseCACity" label="Municipality" type="text" class="slds-p-vertical_x-small" maxlength="50" />
									</lightning:layoutItem>
									<lightning:layoutItem size="6" class="slds-p-horizontal_small">
										<lightning:input aura:id="caseCAZip" name="caseCAZip" label="Postal Code" type="text" class="slds-p-vertical_x-small" maxlength="7" pattern="[ABCEGHJ-NPRSTVXY]{1}[0-9]{1}[ABCEGHJ-NPRSTV-Z]{1}[ ]?[0-9]{1}[ABCEGHJ-NPRSTV-Z]{1}[0-9]{1}" messageWhenPatternMismatch="Enter valid postal code" />
									</lightning:layoutItem> 
								    <!-- address for CA accounts-->     
									<aura:set attribute="else"> 
										<!-- address for US accounts   -->
										<lightning:layoutItem size="6" class="slds-p-horizontal_small">
											<lightning:select aura:id="caseUSState" name="caseUSState" label="State" class="slds-p-vertical_x-small">
												<option value=""></option>
												<aura:iteration items="{!v.states}" var="item">
													<option value="{!item.value}">{!item.label}</option>
												</aura:iteration>
											</lightning:select>
										</lightning:layoutItem>   
                                        <lightning:layoutItem size="6" class="slds-p-horizontal_small">
                                            <lightning:input aura:id="caseUSCity" name="caseUSCity" label="City" type="text" class="slds-p-vertical_x-small" maxlength="50" />
                                        </lightning:layoutItem>
										<lightning:layoutItem size="6" class="slds-p-horizontal_small">
											<lightning:input aura:id="caseUSZip" name="caseUSZip" label="Zip Code" type="text" class="slds-p-vertical_x-small" maxlength="5" pattern="[0-9]{5}" messageWhenPatternMismatch="Enter valid 5 digit zip code" />
										</lightning:layoutItem>  
										<!-- address for US accounts   -->									
									</aura:set>    									
                                </aura:if>
                            </aura:set>    								
						</aura:if>
                    </lightning:layout>
                    <lightning:input aura:id="casePONumberRequired" type="checkbox" label="PO# required for all orders submitted?" name="casePONumberRequired" class="slds-p-top_x-small" />
                    <p class="desc slds-p-top_x-small slds-p-left_large">Is a purchase order going be required on all orders?</p>
                    <aura:set attribute="else">
                        <lightning:input aura:id="caseAccountNumber" name="caseAccountNumber" label="Dal-Tile Account #" type="text" class="slds-p-vertical_x-small" pattern="[0-9]*$" messageWhenPatternMismatch="Enter only numbers, no spaces or special characters " maxlength="12" />
                        <p class="desc ">Account number can be found on your previous sales slip</p>
                    </aura:set>                        
                </aura:if>
                <div class="dal_acctCheckbox">
                    <lightning:input aura:id="caseNewCustomerSetup" type="checkbox" value="true" label="No Account Number?" name="caseNewCustomerSetup" class="slds-p-vertical_x-small" onchange="{!c.handleNewAccount}" messageToggleActive="Need to Become a Customer" messageToggleInactive="Already a Customer" />             
                </div>               
            </div>
            
        </lightning:layoutItem>
        <!-- End Form left column -->
        
        <!-- Form right column -->
        <lightning:layoutItem class="slds-p-horizontal_medium" size="12" smallDeviceSize="12" mediumDeviceSize="6" largeDeviceSize="6">
            <div class="slds-form slds-form_stacked">
                <h4>Contact Information</h4>
                <lightning:input aura:id="caseFirstName" name="caseFirstName" label="First Name" type="text" class="slds-p-vertical_x-small" maxlength="50" />
                <lightning:input aura:id="caseLastName" name="caseLastName" label="Last Name" type="text" class="slds-p-vertical_x-small" maxlength="50" />
                <lightning:input aura:id="caseEmailAddress" name="caseEmailAddress" label="Email Address" type="email" class="slds-p-vertical_x-small" maxlength="50" />
                <lightning:input aura:id="casePhoneNumber" name="casePhoneNumber" label="Phone Number" type="text" class="slds-p-vertical_x-small" maxlength="10" pattern="[0-9]{10}" messageWhenPatternMismatch="Enter 10 digit phone number, no special characters" />               
            </div>
        </lightning:layoutItem>
        <!-- End Form right column -->
        
    </lightning:layout>
    
    <lightning:layout class="slds-p-around_medium" horizontalAlign="end">
        <lightning:layoutItem flexibility="auto" padding="around-small" class="right-align">
            <lightning:button variant="brand" label="Account Request" onclick="{! c.handleSubmit }" />
        </lightning:layoutItem>
    </lightning:layout>
    
    
</aura:component>